# ===================================================================
# TITAN WATCH - Environment Variables
# ===================================================================
#
# This file contains all environment variables needed for the
# Titan Watch microservices architecture.
#
# Usage:
#   1. Copy this file to .env: cp .env.example .env
#   2. Update the values as needed for your environment
#   3. NEVER commit the .env file to version control
#
# ===================================================================

# ===================================================================
# GENERAL SETTINGS
# ===================================================================

NODE_ENV=development
LOG_LEVEL=info
TZ=UTC

# ===================================================================
# POSTGRESQL (Main Database)
# ===================================================================

POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_USER=titanwatch
POSTGRES_PASSWORD=titanwatch_secret
POSTGRES_DB=titanwatch

# Multiple databases for services
# Format: db1,db2,db3
POSTGRES_MULTIPLE_DBS=auth_db,jaeger_db,shatterdome_db,event_db,maintenance_db

# ===================================================================
# MONGODB
# ===================================================================

MONGO_HOST=mongodb
MONGO_PORT=27017
MONGO_ROOT_USER=titanwatch
MONGO_ROOT_PASSWORD=titanwatch_secret
MONGO_DB=titanwatch

# MongoDB Connection Strings
MONGO_KAIJU_URI=mongodb://titanwatch:titanwatch_secret@mongodb:27017/kaiju_db?authSource=admin
MONGO_EVENT_URI=mongodb://titanwatch:titanwatch_secret@mongodb:27017/event_db?authSource=admin

# ===================================================================
# REDIS
# ===================================================================

REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=titanwatch_secret
REDIS_DB=0

# Redis Connection String
REDIS_URL=redis://:titanwatch_secret@redis:6379/0

# ===================================================================
# TIMESCALEDB
# ===================================================================

TIMESCALE_HOST=timescaledb
TIMESCALE_PORT=5433
TIMESCALE_USER=titanwatch
TIMESCALE_PASSWORD=titanwatch_secret
TIMESCALE_DB=tracking_db

# TimescaleDB Connection String
TIMESCALE_URL=postgresql://titanwatch:titanwatch_secret@timescaledb:5433/tracking_db

# ===================================================================
# RABBITMQ
# ===================================================================

RABBITMQ_HOST=rabbitmq
RABBITMQ_PORT=5672
RABBITMQ_MGMT_PORT=15672
RABBITMQ_USER=titanwatch
RABBITMQ_PASSWORD=titanwatch_secret
RABBITMQ_VHOST=titanwatch

# RabbitMQ Connection String
RABBITMQ_URL=amqp://titanwatch:titanwatch_secret@rabbitmq:5672/titanwatch

# ===================================================================
# KAFKA
# ===================================================================

KAFKA_BROKER=kafka:9092
KAFKA_EXTERNAL_BROKER=localhost:29092
ZOOKEEPER_HOST=zookeeper
ZOOKEEPER_PORT=2181

# Kafka Topics (will be auto-created)
KAFKA_TOPIC_EVENTS=titan.events
KAFKA_TOPIC_COMBAT=titan.combat
KAFKA_TOPIC_KAIJU=titan.kaiju
KAFKA_TOPIC_ANALYTICS=titan.analytics

# ===================================================================
# NGINX (API Gateway)
# ===================================================================

NGINX_HTTP_PORT=80
NGINX_HTTPS_PORT=443

# ===================================================================
# PROMETHEUS
# ===================================================================

PROMETHEUS_PORT=9090

# ===================================================================
# GRAFANA
# ===================================================================

GRAFANA_PORT=3000
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=titanwatch_secret
GRAFANA_ROOT_URL=http://localhost:3000

# ===================================================================
# SERVICE: AUTH SERVICE (Go + Chi)
# ===================================================================

AUTH_SERVICE_PORT=8001
AUTH_SERVICE_HOST=auth-service

# JWT Configuration
JWT_SECRET=your-super-secret-jwt-key-change-in-production-min-32-chars
JWT_ACCESS_TOKEN_EXPIRY=15m
JWT_REFRESH_TOKEN_EXPIRY=7d

# Password Hashing
BCRYPT_COST=10

# Database
AUTH_DB_HOST=postgres
AUTH_DB_PORT=5432
AUTH_DB_NAME=auth_db
AUTH_DB_USER=titanwatch
AUTH_DB_PASSWORD=titanwatch_secret
AUTH_DB_SSLMODE=disable

# Redis Cache
AUTH_REDIS_HOST=redis
AUTH_REDIS_PORT=6379
AUTH_REDIS_PASSWORD=titanwatch_secret
AUTH_REDIS_DB=0

# ===================================================================
# SERVICE: JAEGER SERVICE (Node.js + Express)
# ===================================================================

JAEGER_SERVICE_PORT=8002
JAEGER_SERVICE_HOST=jaeger-service

# Database
JAEGER_DB_HOST=postgres
JAEGER_DB_PORT=5432
JAEGER_DB_NAME=jaeger_db
JAEGER_DB_USER=titanwatch
JAEGER_DB_PASSWORD=titanwatch_secret

# Auth Integration
AUTH_SERVICE_URL=http://auth-service:8001

# ===================================================================
# SERVICE: SHATTERDOME SERVICE (Node.js + GraphQL)
# ===================================================================

SHATTERDOME_SERVICE_PORT=8003
SHATTERDOME_SERVICE_HOST=shatterdome-service

# Database
SHATTERDOME_DB_HOST=postgres
SHATTERDOME_DB_PORT=5432
SHATTERDOME_DB_NAME=shatterdome_db
SHATTERDOME_DB_USER=titanwatch
SHATTERDOME_DB_PASSWORD=titanwatch_secret

# GraphQL
GRAPHQL_PLAYGROUND=true
GRAPHQL_INTROSPECTION=true

# Service Integration
JAEGER_SERVICE_URL=http://jaeger-service:8002

# ===================================================================
# SERVICE: KAIJU SERVICE (Python + FastAPI)
# ===================================================================

KAIJU_SERVICE_PORT=8004
KAIJU_SERVICE_HOST=kaiju-service

# Database
KAIJU_MONGO_URI=mongodb://titanwatch:titanwatch_secret@mongodb:27017/kaiju_db?authSource=admin

# Detection Settings
DETECTION_INTERVAL_SECONDS=30
THREAT_CALCULATION_ENABLED=true

# ===================================================================
# SERVICE: TRACKING SERVICE (Go + Gin + CQRS)
# ===================================================================

TRACKING_SERVICE_PORT=8005
TRACKING_SERVICE_HOST=tracking-service

# Write Side
TRACKING_WRITE_PORT=8005

# Read Side
TRACKING_READ_PORT=8006

# Database
TRACKING_DB_URL=postgresql://titanwatch:titanwatch_secret@timescaledb:5433/tracking_db

# Redis Cache
TRACKING_REDIS_HOST=redis
TRACKING_REDIS_PORT=6379
TRACKING_REDIS_PASSWORD=titanwatch_secret
TRACKING_REDIS_DB=1

# Performance
TRACKING_BATCH_SIZE=1000
TRACKING_BATCH_INTERVAL_MS=100

# ===================================================================
# SERVICE: EVENT SERVICE (Java + Spring Boot)
# ===================================================================

EVENT_SERVICE_PORT=8007
EVENT_SERVICE_HOST=event-service

# Event Store (MongoDB)
EVENT_STORE_URI=mongodb://titanwatch:titanwatch_secret@mongodb:27017/event_db?authSource=admin

# Projections (PostgreSQL)
EVENT_PROJECTION_HOST=postgres
EVENT_PROJECTION_PORT=5432
EVENT_PROJECTION_DB=event_db
EVENT_PROJECTION_USER=titanwatch
EVENT_PROJECTION_PASSWORD=titanwatch_secret

# Kafka
EVENT_KAFKA_BROKER=kafka:9092
EVENT_KAFKA_TOPIC=titan.events

# ===================================================================
# SERVICE: MAINTENANCE SERVICE (Node.js + NestJS + Saga)
# ===================================================================

MAINTENANCE_SERVICE_PORT=8008
MAINTENANCE_SERVICE_HOST=maintenance-service

# Database
MAINTENANCE_DB_HOST=postgres
MAINTENANCE_DB_PORT=5432
MAINTENANCE_DB_NAME=maintenance_db
MAINTENANCE_DB_USER=titanwatch
MAINTENANCE_DB_PASSWORD=titanwatch_secret

# RabbitMQ
MAINTENANCE_RABBITMQ_URL=amqp://titanwatch:titanwatch_secret@rabbitmq:5672/titanwatch

# Redis (Saga State)
MAINTENANCE_REDIS_HOST=redis
MAINTENANCE_REDIS_PORT=6379
MAINTENANCE_REDIS_PASSWORD=titanwatch_secret
MAINTENANCE_REDIS_DB=2

# Service Integration
MAINTENANCE_JAEGER_URL=http://jaeger-service:8002

# Saga Settings
SAGA_TIMEOUT_MS=300000
SAGA_RETRY_ATTEMPTS=3
SAGA_RETRY_DELAY_MS=5000

# ===================================================================
# SERVICE: ANALYTICS SERVICE (Python + Spark)
# ===================================================================

ANALYTICS_SERVICE_PORT=8009
ANALYTICS_SERVICE_HOST=analytics-service

# Spark
SPARK_MASTER=local[*]
SPARK_DRIVER_MEMORY=2g

# Kafka
ANALYTICS_KAFKA_BROKER=kafka:9092

# Database
ANALYTICS_DB_HOST=postgres
ANALYTICS_DB_PORT=5432
ANALYTICS_DB_NAME=analytics_db
ANALYTICS_DB_USER=titanwatch
ANALYTICS_DB_PASSWORD=titanwatch_secret

# Redis Cache
ANALYTICS_REDIS_HOST=redis
ANALYTICS_REDIS_PORT=6379
ANALYTICS_REDIS_PASSWORD=titanwatch_secret
ANALYTICS_REDIS_DB=3

# Batch Jobs
ANALYTICS_BATCH_INTERVAL_HOURS=24

# ===================================================================
# WORKERS
# ===================================================================

# Notification Worker
NOTIFICATION_WORKER_RABBITMQ_URL=amqp://titanwatch:titanwatch_secret@rabbitmq:5672/titanwatch
NOTIFICATION_WORKER_RETRY_ATTEMPTS=5
NOTIFICATION_WORKER_RETRY_DELAY_MS=3000

# Email Settings (Mock)
SMTP_HOST=smtp.mailtrap.io
SMTP_PORT=2525
SMTP_USER=
SMTP_PASSWORD=
SMTP_FROM=noreply@titanwatch.io

# SMS Settings (Mock)
SMS_PROVIDER=twilio
SMS_ACCOUNT_SID=
SMS_AUTH_TOKEN=
SMS_FROM_NUMBER=

# Push Notification Settings (Mock)
PUSH_PROVIDER=fcm
PUSH_SERVER_KEY=

# ===================================================================
# FRONTEND
# ===================================================================

FRONTEND_PORT=3001
FRONTEND_HOST=frontend

# API URLs (from browser perspective)
VITE_API_GATEWAY_URL=http://localhost:80
VITE_AUTH_SERVICE_URL=http://localhost:80/api/auth
VITE_JAEGER_SERVICE_URL=http://localhost:80/api/jaegers
VITE_SHATTERDOME_GRAPHQL_URL=http://localhost:80/graphql
VITE_KAIJU_SERVICE_URL=http://localhost:80/api/kaijus
VITE_TRACKING_SERVICE_URL=http://localhost:80/api/tracking

# Mapbox
VITE_MAPBOX_ACCESS_TOKEN=your-mapbox-token-here

# ===================================================================
# DEVELOPMENT TOOLS
# ===================================================================

# Enable debug mode
DEBUG=false

# Enable hot reload
HOT_RELOAD=true

# Enable API documentation
ENABLE_SWAGGER=true
ENABLE_GRAPHQL_PLAYGROUND=true

# ===================================================================
# SECURITY
# ===================================================================

# CORS Origins (comma-separated)
CORS_ORIGINS=http://localhost:3001,http://localhost:80

# Rate Limiting
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100

# ===================================================================
# MONITORING & OBSERVABILITY
# ===================================================================

# Enable metrics collection
METRICS_ENABLED=true
METRICS_PORT=9091

# Enable distributed tracing
TRACING_ENABLED=false
JAEGER_AGENT_HOST=jaeger
JAEGER_AGENT_PORT=6831

# ===================================================================
# TESTING
# ===================================================================

# Test Database (used in CI/CD)
TEST_POSTGRES_HOST=localhost
TEST_POSTGRES_PORT=5432
TEST_POSTGRES_USER=test_user
TEST_POSTGRES_PASSWORD=test_password
TEST_POSTGRES_DB=test_db

# ===================================================================
# NOTES
# ===================================================================
#
# Security Best Practices:
# 1. Change all default passwords before production
# 2. Use strong, unique passwords (min 32 characters)
# 3. Rotate JWT secret regularly
# 4. Never commit .env file to version control
# 5. Use secret management tools in production (Vault, AWS Secrets Manager)
#
# Performance Tuning:
# 1. Adjust batch sizes based on your hardware
# 2. Configure memory limits for databases
# 3. Enable connection pooling
# 4. Monitor and adjust cache sizes
#
# ===================================================================
